import{u as oe}from"./provide-16c71a76.js";import{v as se,e as L}from"./elements-1fb47fa1.js";import{d as ie,a as h,c as ve,w as ce}from"./logger-9a144f5d.js";import{d as fe,a as d,b as de,w as R,v as me,Z as P,X as he,aH as pe,_ as Te,f as w,h as g,M as we,O as W,N as S,R as M,F as ge,ah as Se,j as ke}from"./vue-router-547718df.js";import{o as ye}from"./onSmartUnmounted-610a74e1.js";import{o as Ie}from"./onWindowResize-4d20ed42.js";import{u as be}from"./useTouch-e2562605.js";import{a as $e}from"./provide-c650129a.js";const Ce={loop:{type:Boolean,default:!0},autoplay:[String,Number],duration:{type:[String,Number],default:300},initialIndex:{type:[String,Number],default:0},indicator:{type:Boolean,default:!0},indicatorColor:String,vertical:Boolean,touchable:{type:Boolean,default:!0},onChange:ie()},ze=250,Ne=20,{n:Ee,classes:Pe}=ve("swipe"),Be=fe({name:"VarSwipe",props:Ce,setup(e){const v=d(null),r=d(0),B=de(()=>e.vertical),c=d(0),u=d(0),o=d(!1),l=d(0),{swipeItems:k,bindSwipeItems:V,length:t}=oe(),{popup:D,bindPopup:q}=$e(),{deltaX:H,deltaY:O,moveX:j,moveY:U,offsetX:Z,offsetY:G,touching:A,direction:J,startTime:K,startTouch:Q,moveTouch:_,endTouch:x}=be();let F=!1,y=-1;const f=a=>k.find(({index:n})=>n.value===a),ee=()=>{e.loop&&(u.value>=0&&f(t.value-1).setTranslate(-c.value),u.value<=-(c.value-r.value)&&f(0).setTranslate(c.value),u.value>-(c.value-r.value)&&u.value<0&&(f(t.value-1).setTranslate(0),f(0).setTranslate(0)))},I=a=>{const n=he(a)?a:Math.floor((u.value-r.value/2)/-r.value),{loop:s}=e;return n<=-1?s?-1:0:n>=t.value?s?t.value:t.value-1:n},ae=a=>{const{loop:n}=e;return a===-1?n?t.value-1:0:a===t.value?n?0:t.value-1:a},b=a=>e.loop?a<0?t.value+a:a>=t.value?a-t.value:a:pe(a,0,t.value-1),$=a=>{const n=u.value>=r.value,s=u.value<=-c.value,i=0,E=-(c.value-r.value);o.value=!0,(n||s)&&(o.value=!0,u.value=s?i:E,f(0).setTranslate(0),f(t.value-1).setTranslate(0)),se(()=>{o.value=!1,h(a)})},C=()=>{F||(l.value=b(P(e.initialIndex)),F=!0)},z=()=>{const{autoplay:a}=e;!a||t.value<=1||(p(),y=window.setTimeout(()=>{N(),z()},P(a)))},p=()=>{y&&clearTimeout(y)},X=a=>{u.value=a,ee()},te=a=>{t.value<=1||!e.touchable||(Q(a),p(),$(()=>{o.value=!0}))},le=a=>{const{touchable:n,vertical:s}=e;if(!A.value||!n)return;_(a);const i=s?"vertical":"horizontal";J.value===i&&(a.preventDefault(),X(u.value+(s?U.value:j.value)))},ne=()=>{if(!A.value)return;const{vertical:a,onChange:n}=e;x();const s=a?O.value<0:H.value<0,i=a?G.value:Z.value,T=performance.now()-K.value<=ze&&i>=Ne?I(s?l.value+1:l.value-1):I();o.value=!1,X(T*-r.value);const re=l.value;l.value=ae(T),z(),re!==l.value&&h(n,l.value)},m=()=>{v.value&&(o.value=!0,r.value=e.vertical?v.value.offsetHeight:v.value.offsetWidth,c.value=r.value*t.value,u.value=l.value*-r.value,k.forEach(a=>{a.setTranslate(0)}),z(),setTimeout(()=>{o.value=!1}))},N=a=>{if(t.value<=1)return;C();const{loop:n,onChange:s}=e,i=l.value;l.value=b(i+1),(a==null?void 0:a.event)!==!1&&h(s,l.value),$(()=>{if(i===t.value-1&&n){f(0).setTranslate(c.value),u.value=t.value*-r.value;return}i!==t.value-1&&(u.value=l.value*-r.value)})},Y=a=>{if(t.value<=1)return;C();const{loop:n,onChange:s}=e,i=l.value;l.value=b(i-1),(a==null?void 0:a.event)!==!1&&h(s,l.value),$(()=>{if(i===0&&n){f(t.value-1).setTranslate(-c.value),u.value=r.value;return}i!==0&&(u.value=l.value*-r.value)})},ue=(a,n)=>{if(t.value<=1||a===l.value)return;a=a<0?0:a,a=a>=t.value?t.value:a;const s=a>l.value?N:Y,i=Math.abs(a-l.value);Array.from({length:i}).forEach((E,T)=>{s({event:T===i-1?n==null?void 0:n.event:!1})})};return V({size:r,vertical:B}),h(q,null),R(()=>t.value,async()=>{await L(),C(),m()}),D&&R(()=>D.show.value,async a=>{a?(await L(),m()):p()}),me(m),ye(p),Ie(m),{n:Ee,classes:Pe,length:t,index:l,swipeEl:v,trackSize:c,trackTranslate:u,lockDuration:o,handleTouchstart:te,handleTouchmove:le,handleTouchend:ne,next:N,prev:Y,to:ue,resize:m,toNumber:P}}});const De=["onClick"];function Ae(e,v,r,B,c,u){return w(),g("div",{class:S(e.n()),ref:"swipeEl"},[we("div",{class:S(e.classes(e.n("track"),[e.vertical,e.n("--vertical")])),style:M({width:e.vertical?void 0:`${e.trackSize}px`,height:e.vertical?`${e.trackSize}px`:void 0,transform:`translate${e.vertical?"Y":"X"}(${e.trackTranslate}px)`,transitionDuration:e.lockDuration?"0ms":`${e.toNumber(e.duration)}ms`}),onTouchstart:v[0]||(v[0]=(...o)=>e.handleTouchstart&&e.handleTouchstart(...o)),onTouchmove:v[1]||(v[1]=(...o)=>e.handleTouchmove&&e.handleTouchmove(...o)),onTouchend:v[2]||(v[2]=(...o)=>e.handleTouchend&&e.handleTouchend(...o))},[W(e.$slots,"default")],38),W(e.$slots,"indicator",{index:e.index,length:e.length},()=>[e.indicator&&e.length?(w(),g("div",{key:0,class:S(e.classes(e.n("indicators"),[e.vertical,e.n("--indicators-vertical")]))},[(w(!0),g(ge,null,Se(e.length,(o,l)=>(w(),g("div",{class:S(e.classes(e.n("indicator"),[e.index===l,e.n("--indicator-active")],[e.vertical,e.n("--indicator-vertical")])),style:M({background:e.indicatorColor}),key:o,onClick:k=>e.to(l)},null,14,De))),128))],2)):ke("",!0)])],2)}const Fe=Te(Be,[["render",Ae]]);ce(Fe);export{Fe as S,Ce as p};
