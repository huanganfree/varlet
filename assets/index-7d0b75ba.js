import{I as Q}from"./index-d9f34410.js";import{g as _,c as H}from"./elements-75b8c791.js";import{d as k,c as J,a as D,w as K}from"./components-b4bea23d.js";import{d as W,r as n,D as h,ac as X,b5 as Z,G as x,at as ee,a7 as ae,ah as oe,ai as R,aO as se,ae as te,a4 as T,n as ne,_ as O,b as le,e as g,m as A,p as re,q as ue,x as N,y as ce,v as ie,al as de,f as V,w as $,U as B,O as ve,Q as fe,R as me,N as he}from"./index-ba2bae36.js";import{C as Te}from"./index-f2c276e1.js";import{d as ge}from"./index-d8fbf18c.js";import"./logger-525ef361.js";import"./index-85ab28c6.js";import"./index-bc58714c.js";/* empty css               */const pe={modelValue:Boolean,disabled:Boolean,animationDuration:{type:[Number,String],default:300},successDuration:{type:[Number,String],default:2e3},bgColor:String,successBgColor:String,color:String,successColor:String,target:[String,Object],onRefresh:k(),"onUpdate:modelValue":k()},{name:Se,n:L,classes:Ne}=J("pull-refresh"),P=150,we=W({name:Se,components:{VarIcon:Q},props:pe,setup(e){const o=n(0),v=n(null),c=n(null),i=n(0),s=n("-125%"),l=n("arrow-down"),a=n("default"),r=n(!1),u=h(()=>Math.abs(2*o.value)),p=h(()=>a.value==="success"),w=h(()=>a.value!=="loading"&&a.value!=="success"&&!e.disabled),U=h(()=>({transform:`translate3d(0px, ${X(s.value)?s.value:`${s.value}px`}, 0px) translate(-50%, 0)`,transition:r.value?`transform ${e.animationDuration}ms`:void 0,background:p.value?e.successBgColor:e.bgColor,color:p.value?e.successColor:e.color})),{startTouch:M,moveTouch:z,endTouch:Y,isReachTop:y}=Z();let d,m;x(()=>e.modelValue,t=>{t===!1&&(r.value=!0,a.value="success",l.value="checkbox-marked-circle",setTimeout(()=>{s.value=o.value,G()},T(e.successDuration)))}),ee(F),ae(v,"touchmove",I);async function b(t){if(l.value!==t)return l.value=t,new Promise(f=>{window.setTimeout(f,P)})}function S(t){("classList"in d?d:document.body).classList[t](`${L()}--lock`)}function j(t){if(M(t),o.value===0){const{width:f}=oe(c.value);o.value=-(f+f*.25)}m=_(t.target)}function I(t){if(z(t),!w.value||!m||m!==d&&R(m)>0||R(d)>0)return;y(d)&&se(t),a.value!=="pulling"&&(a.value="pulling",i.value=t.touches[0].clientY),y(d)&&te(s.value)&&s.value>o.value&&S("add");const C=(t.touches[0].clientY-i.value)/2+o.value;s.value=C>=u.value?u.value:C,b(s.value>=u.value*.2?"refresh":"arrow-down")}async function q(){Y(),w.value&&(r.value=!0,T(s.value)>=u.value*.2?(await b("refresh"),a.value="loading",s.value=u.value*.3,D(e["onUpdate:modelValue"],!0),ne(()=>{D(e.onRefresh)}),S("remove")):(a.value="loosing",l.value="arrow-down",s.value=o.value,setTimeout(()=>{r.value=!1,S("remove")},T(e.animationDuration))),m=null)}function F(){d=e.target?H(e.target,"PullRefresh"):_(v.value)}function G(){setTimeout(()=>{a.value="default",l.value="arrow-down",r.value=!1},T(e.animationDuration))}return{ICON_TRANSITION:P,refreshStatus:a,freshNode:v,controlNode:c,iconName:l,controlStyle:U,isSuccess:p,n:L,classes:Ne,handleTouchstart:j,handleTouchmove:I,handleTouchend:q}}});function ye(e,o,v,c,i,s){const l=le("var-icon");return g(),A("div",{ref:"freshNode",class:N(e.n()),onTouchstart:o[0]||(o[0]=(...a)=>e.handleTouchstart&&e.handleTouchstart(...a)),onTouchend:o[1]||(o[1]=(...a)=>e.handleTouchend&&e.handleTouchend(...a)),onTouchcancel:o[2]||(o[2]=(...a)=>e.handleTouchend&&e.handleTouchend(...a))},[re("div",{ref:"controlNode",class:N(e.classes(e.n("control"),e.n("$-elevation--2"),[e.isSuccess,e.n("control-success")])),style:ce(e.controlStyle)},[ue(l,{name:e.iconName,transition:e.ICON_TRANSITION,class:N(e.classes(e.n("icon"),[e.refreshStatus==="loading",e.n("animation")])),"var-pull-refresh-cover":""},null,8,["name","transition","class"])],6),ie(e.$slots,"default")],34)}const E=O(we,[["render",ye]]);K(E);const be={__name:"index",setup(e){const o=Array(30).fill("List Item"),v=Array(30).fill("This is new List Item"),c=n(!1),i=n(o);function s(){setTimeout(()=>{i.value=i.value[0]==="List Item"?v:o,c.value=!1},2e3)}return de(ge),(l,a)=>(g(),V(B(E),{onRefresh:s,modelValue:c.value,"onUpdate:modelValue":a[0]||(a[0]=r=>c.value=r),"success-duration":"2000"},{default:$(()=>[(g(!0),A(he,null,ve(i.value,(r,u)=>(g(),V(B(Te),{key:u,border:""},{default:$(()=>[fe(me(r+" "+(u+1)),1)]),_:2},1024))),128))]),_:1},8,["modelValue"]))}},Pe=O(be,[["__scopeId","data-v-6f15a34c"]]);export{Pe as default};
