import{B as ye}from"./index-b6014f56.js";import{I as be}from"./index-d9f34410.js";import{H as ke}from"./index-2a9d0a0e.js";import{u as Se}from"./provide-b7386d59.js";import{d as Ie,a as $,c as $e,w as Ce}from"./components-b4bea23d.js";import{d as Ne,r as h,D as j,b5 as Pe,G,a8 as ze,aJ as Be,aC as De,a4 as L,aO as Ee,j as R,ae as Ae,aD as He,_ as Le,b as J,L as Re,P as Ve,e as g,m as p,p as Ye,v as C,x as d,y as Q,q as T,w as N,t as y,T as U,aQ as V,as as K,N as We,O as Xe,aR as qe}from"./index-ba2bae36.js";import{a as Fe}from"./provide-aabba7a2.js";const Oe={loop:{type:Boolean,default:!0},autoplay:[String,Number],duration:{type:[String,Number],default:300},initialIndex:{type:[String,Number],default:0},navigation:{type:[Boolean,String],default:!1},indicator:{type:Boolean,default:!0},indicatorColor:String,vertical:Boolean,touchable:{type:Boolean,default:!0},onChange:Ie()},Me=250,je=20,{name:Ge,n:Z,classes:Je}=$e("swipe"),Qe=Ne({name:Ge,directives:{Hover:ke},components:{VarButton:ye,VarIcon:be},props:Oe,setup(e){const r=h(null),o=h(0),Y=j(()=>e.vertical),f=h(0),i=h(0),c=h(!1),t=h(0),b=h(!1),{swipeItems:s,bindSwipeItems:k,length:n}=Se(),{popup:W,bindPopup:x}=Fe(),{deltaX:_,deltaY:ee,moveX:ae,moveY:ne,offsetX:te,offsetY:le,touching:X,direction:ie,startTime:oe,startTouch:re,moveTouch:ue,endTouch:ve}=Pe(),q=j(()=>ie.value===(e.vertical?"vertical":"horizontal"));let F=!1,P=-1;k({size:o,vertical:Y}),$(x,null),G(()=>n.value,async()=>{await R(),E(),w()}),W&&G(()=>W.show.value,async a=>{a?(await R(),w()):S()}),ze(w),Be(S),De(w);function m(a){return s.find(({index:l})=>l.value===a)}function se(){e.loop&&(i.value>=0&&m(n.value-1).setTranslate(-f.value),i.value<=-(f.value-o.value)&&m(0).setTranslate(f.value),i.value>-(f.value-o.value)&&i.value<0&&(m(n.value-1).setTranslate(0),m(0).setTranslate(0)))}function z(a){const l=Ae(a)?a:Math.floor((i.value-o.value/2)/-o.value),{loop:u}=e;return l<=-1?u?-1:0:l>=n.value?u?n.value:n.value-1:l}function fe(a){const{loop:l}=e;return a===-1?l?n.value-1:0:a===n.value?l?0:n.value-1:a}function B(a){return e.loop?a<0?n.value+a:a>=n.value?a-n.value:a:He(a,0,n.value-1)}async function D(){const a=i.value>=o.value,l=i.value<=-f.value,u=0,v=-(f.value-o.value);c.value=!0,(a||l)&&(c.value=!0,i.value=l?u:v,m(0).setTranslate(0),m(n.value-1).setTranslate(0)),await R(),c.value=!1}function E(){F||(t.value=B(L(e.initialIndex)),F=!0)}function A(){const{autoplay:a}=e;!a||n.value<=1||(S(),P=window.setTimeout(()=>{H(),A()},L(a)))}function S(){P&&clearTimeout(P)}function O(a){i.value=a,se()}async function ce(a){n.value<=1||!e.touchable||(re(a),S(),await D(),c.value=!0)}function de(a){const{touchable:l,vertical:u}=e;!X.value||!l||(ue(a),q.value&&(Ee(a),O(i.value+(u?ne.value:ae.value))))}function me(){if(!X.value||(ve(),!q.value))return;const{vertical:a,onChange:l}=e,u=a?ee.value<0:_.value<0,v=a?le.value:te.value,I=performance.now()-oe.value<=Me&&v>=je?z(u?t.value+1:t.value-1):z();c.value=!1,O(I*-o.value);const we=t.value;t.value=fe(I),A(),we!==t.value&&$(l,t.value)}function he(a){e.navigation==="hover"&&(b.value=a)}function ge(a){return e.navigation!=="hover"?"":Z(`--navigation${e.vertical?"-vertical":""}-${a}-animation`)}function w(){r.value&&(c.value=!0,o.value=e.vertical?r.value.offsetHeight:r.value.offsetWidth,f.value=o.value*n.value,i.value=t.value*-o.value,s.forEach(a=>{a.setTranslate(0)}),A(),setTimeout(()=>{c.value=!1}))}async function H(a){if(n.value<=1)return;E();const{loop:l,onChange:u}=e,v=t.value;if(t.value=B(v+1),(a==null?void 0:a.event)!==!1&&$(u,t.value),await D(),v===n.value-1&&l){m(0).setTranslate(f.value),i.value=n.value*-o.value;return}v!==n.value-1&&(i.value=t.value*-o.value)}async function M(a){if(n.value<=1)return;E();const{loop:l,onChange:u}=e,v=t.value;if(t.value=B(v-1),(a==null?void 0:a.event)!==!1&&$(u,t.value),await D(),v===0&&l){m(n.value-1).setTranslate(-f.value),i.value=o.value;return}v!==0&&(i.value=t.value*-o.value)}function pe(a,l){if(n.value<=1||a===t.value)return;a=a<0?0:a,a=a>=n.value?n.value:a;const u=a>t.value?H:M,v=Math.abs(a-t.value);Array.from({length:v}).forEach((Te,I)=>{u({event:I===v-1?l==null?void 0:l.event:!1})})}return{length:n,index:t,swipeEl:r,trackSize:f,trackTranslate:i,lockDuration:c,hovering:b,n:Z,classes:Je,handleTouchstart:ce,handleTouchmove:de,handleTouchend:me,next:H,prev:M,to:pe,resize:w,toNumber:L,handleHovering:he,getNavigationAnimation:ge}}});const Ue=["onClick"];function Ke(e,r,o,Y,f,i){const c=J("var-icon"),t=J("var-button"),b=Re("hover");return Ve((g(),p("div",{class:d(e.n()),ref:"swipeEl"},[Ye("div",{class:d(e.classes(e.n("track"),[e.vertical,e.n("--vertical")])),style:Q({width:e.vertical?void 0:`${e.trackSize}px`,height:e.vertical?`${e.trackSize}px`:void 0,transform:`translate${e.vertical?"Y":"X"}(${e.trackTranslate}px)`,transitionDuration:e.lockDuration?"0ms":`${e.toNumber(e.duration)}ms`}),onTouchstart:r[0]||(r[0]=(...s)=>e.handleTouchstart&&e.handleTouchstart(...s)),onTouchmove:r[1]||(r[1]=(...s)=>e.handleTouchmove&&e.handleTouchmove(...s)),onTouchend:r[2]||(r[2]=(...s)=>e.handleTouchend&&e.handleTouchend(...s))},[C(e.$slots,"default")],38),e.navigation?C(e.$slots,"prev",V(K({key:0},{index:e.index,length:e.length,prev:e.prev,next:e.next,to:e.to,hovering:e.hovering})),()=>[T(U,{name:e.getNavigationAnimation("prev")},{default:N(()=>[e.navigation===!0||e.hovering?(g(),p("div",{key:0,class:d(e.classes(e.n("navigation"),e.n("navigation-prev"),[e.vertical,e.n("--navigation-vertical-prev")]))},[T(t,{"var-swipe-cover":"",disabled:!e.loop&&e.index===0,class:d(e.n("navigation-prev-button")),onClick:r[3]||(r[3]=s=>e.prev())},{default:N(()=>[T(c,{"var-swipe-cover":"",class:d(e.n("navigation-prev-button-icon")),name:e.vertical?"chevron-up":"chevron-left"},null,8,["class","name"])]),_:1},8,["disabled","class"])],2)):y("",!0)]),_:1},8,["name"])]):y("",!0),e.navigation?C(e.$slots,"next",V(K({key:1},{index:e.index,length:e.length,hovering:e.hovering,prev:e.prev,next:e.next,to:e.to})),()=>[T(U,{name:e.getNavigationAnimation("next")},{default:N(()=>[e.navigation===!0||e.hovering?(g(),p("div",{key:0,class:d(e.classes(e.n("navigation"),e.n("navigation-next"),[e.vertical,e.n("--navigation-vertical-next")]))},[T(t,{"var-swipe-cover":"",class:d(e.n("navigation-next-button")),disabled:!e.loop&&e.index===e.length-1,onClick:r[4]||(r[4]=s=>e.next())},{default:N(()=>[T(c,{"var-swipe-cover":"",class:d(e.n("navigation-next-button-icon")),name:e.vertical?"chevron-down":"chevron-right"},null,8,["class","name"])]),_:1},8,["class","disabled"])],2)):y("",!0)]),_:1},8,["name"])]):y("",!0),C(e.$slots,"indicator",V(qe({index:e.index,length:e.length,hovering:e.hovering,prev:e.prev,next:e.next,to:e.to})),()=>[e.indicator&&e.length?(g(),p("div",{key:0,class:d(e.classes(e.n("indicators"),[e.vertical,e.n("--indicators-vertical")]))},[(g(!0),p(We,null,Xe(e.length,(s,k)=>(g(),p("div",{class:d(e.classes(e.n("indicator"),[e.index===k,e.n("--indicator-active")],[e.vertical,e.n("--indicator-vertical")])),style:Q({background:e.indicatorColor}),key:s,onClick:n=>e.to(k)},null,14,Ue))),128))],2)):y("",!0)])],2)),[[b,e.handleHovering]])}const Ze=Le(Qe,[["render",Ke]]);Ce(Ze);export{Ze as S,Oe as p};
